<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>데이터 분석 방법론 - 3&nbsp; 연관성의 검정</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/diagnose.html" rel="next">
<link href="../notes/association.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/association.html">분할표의 분석</a></li><li class="breadcrumb-item"><a href="../notes/association-test.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">연관성의 검정</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">데이터 분석 방법론</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ilovedata/statmehods" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../데이터-분석-방법론-.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">서론</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">분할표의 분석</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/association.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">연관성의 측도</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/association-test.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">연관성의 검정</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/diagnose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">진단의 평가</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#필요한-패키지" id="toc-필요한-패키지" class="nav-link active" data-scroll-target="#필요한-패키지"><span class="header-section-number">3.1</span> 필요한 패키지</a></li>
  <li><a href="#카이제곱-검정" id="toc-카이제곱-검정" class="nav-link" data-scroll-target="#카이제곱-검정"><span class="header-section-number">3.2</span> 카이제곱 검정</a></li>
  <li><a href="#코크란-맨텔-헨젤-검정" id="toc-코크란-맨텔-헨젤-검정" class="nav-link" data-scroll-target="#코크란-맨텔-헨젤-검정"><span class="header-section-number">3.3</span> 코크란-맨텔-헨젤 검정</a></li>
  <li><a href="#맥나마-검정" id="toc-맥나마-검정" class="nav-link" data-scroll-target="#맥나마-검정"><span class="header-section-number">3.4</span> 맥나마 검정</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="binomialtest" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">연관성의 검정</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>이 절에서는 두 변수의 연관성에 통계적 가설 검정 방법을 살펴보자.</p>
<section id="필요한-패키지" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="필요한-패키지"><span class="header-section-number">3.1</span> 필요한 패키지</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#: warning: flase</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#: output: false</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#: message: false</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival
Package epiR 2.0.63 is loaded
Type help(epi.about) for summary information
Type browseVignettes(package = 'epiR') to learn how to use epiR for applied epidemiological analyses</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="카이제곱-검정" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="카이제곱-검정"><span class="header-section-number">3.2</span> 카이제곱 검정</h2>
<p>일단 2개의 이항변수 <span class="math inline">\(X\)</span> 와 <span class="math inline">\(Y\)</span> 를 고려하고 가능한 결과의 조합과 그 확률은 다음과 같은 <span class="math inline">\(2 \times 2\)</span> 분할표로 나타낼 수 있다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/table22-01.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">2 x 2 분할표</figcaption>
</figure>
</div>
<pre><code>table22p, out.width='50%', echo=FALSE, fig.align='center', fig.cap= "2 x 2 분할표: 확률분포"  
knitr::include_graphics("myimages/table22-01.png")</code></pre>
<p>일반적으로 <span class="math inline">\(2 \times 2\)</span> 분할표에서 다음과 같은 두 가지 가설이 가능하다.</p>
<ul>
<li><p>동질성 검정(homogeneuty test)</p>
<p>변수 <span class="math inline">\(X\)</span> 가 단순하게 독립 집단을 나누는 변수인 경우 (예를 들어 실험약 집단과 위약 집단) 두 그룹 간에 이항변수 <span class="math inline">\(Y\)</span>의 성공확률이 같은지 검정하는 경우이다. 실험약 집단과 위약 집단에서 심장병이 발병할 확률이 같은지 검정을 수행할 때 귀무가설은 다음과 같다.</p></li>
</ul>
<p><span class="math display">\[ H_0: p_{1j} = p_{2j} = p_j \]</span></p>
<ul>
<li><p>독립성 검정(independent test)</p>
<p>변수 <span class="math inline">\(X\)</span> 와 <span class="math inline">\(Y\)</span> 가 모두 확률변수인 경우 두 변수가 독립인지 검정하는 경우이다. 예를 들어 흡연(<span class="math inline">\(X\)</span>)과 심근경색(<span class="math inline">\(Y\)</span>)의 관계를 연구하는 경우 두 사건이 모두 확률적인 사건이라고 보고 다음과 같이 독립에 대한 가설을 고려한다.</p></li>
</ul>
<p><span class="math display">\[ H_0: p_{ij} = p_{i+} p_{+j} \]</span></p>
<p>다음과 같이 <span class="math inline">\(n\)</span> 개의 관측값으로 구성된 <span class="math inline">\(2 \times 2\)</span> 분할표에서 <strong>동질성과 독립성 가설을 검정하는 방법은 동일하며</strong> 따라서 굳이 두 가지 가설을 엄격하게 구별할 이유는 없다. 만약 귀무가설이 기각되면 두 변수의 연과성은 유의하다고 결론을 내린다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/table22-02.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">2 x 2 분할표: 관측 도수</figcaption>
</figure>
</div>
<pre><code>table22n, out.width='50%', echo=FALSE, fig.align='center', fig.cap="2 x 2 분할표: 관측 도수"  }
knitr::include_graphics("myimages/table22-02.png")</code></pre>
<p>동질성과 독립성에 대한 검정은 다음과 같은 <strong>카이제곱 통계량</strong>을 사용한다.</p>
<p><span class="math display">\[\begin{equation}
\chi^2 = \sum_{i=1}^2 \sum_{j=1}^2 \frac{(O_{ij} - E_{ij})^2}{E_ij}  
(\#eq:chisquarestat)
\end{equation}\]</span></p>
<p>위의 카이제곱 통계량에서 <span class="math inline">\(O_{ij} = n_{ij}\)</span> 는 각 셀의 관측도수이며 <span class="math inline">\(E_{ij}\)</span>는 귀무가설 하에서의 셀 도수의 예측값이다.<br>
동질성 검정을 고려할 때 만약 귀무가설이 참이라면 확률 <span class="math inline">\(p_{1j} =p_{2j}=p_j\)</span> 는 다음과 같이 추정할 수 있다.</p>
<p><span class="math display">\[ \hat p_{j} = \frac{n_{+j}}{n} \]</span></p>
<p>따라서 셀 <span class="math inline">\((i,j)\)</span> 에 대한 기데 돗수 <span class="math inline">\(E_{ij}\)</span> 는 다음과 같이 계산된다.</p>
<p><span class="math display">\[\begin{equation}
E_{ij} =n_{i+} \hat p_j =\frac{n_{i+} n_{+j}}{n}
(\#eq:chisquareexp)
\end{equation}\]</span></p>
<p>귀무가설 하에서 표본의 크기가 충분히 크면 식 @ref(eq:chisquarestat) 의 카이제곱 검정통계량 <span class="math inline">\(\chi^2\)</span> 는 자유도가 1인 카이제곱 분포를 따른다. 그러므로 이 사실을 이용하여 p-값을 계산하거나 기각역을 구하여 검정한다.</p>
<p>일반적인 <span class="math inline">\(I \times J\)</span> 분할표도 동일한 방법으로 가설검정을 할 수 있다. 카이제곱 통계량을 구하는 방법은 <span class="math inline">\(2 \times 2\)</span> 분할표와 유사하다. 다만 귀무가설이 참인 경우 검정통계량은 자유도가 <span class="math inline">\((I-1)(J-1)\)</span> 인 카이제곱 분포를 따른다.</p>
<p><span class="math display">\[
\chi^2 = \sum_{i=1}^I \sum_{j=1}^J \frac{(O_{ij} - E_{ij})^2}{E_ij}  
\]</span></p>
<p>이제 실제 분할표에서 카이제곱 검정을 수행해 보자. 아스피린 임상실험 결과가 주어진 표 @ref(tab:conttable25) 에서 아스피린의 횩과사 없는 경우, 즉 귀무가설이 참인 경우 다음과 같이 심근경색의 유무에 대한 예측 확률을 구할 수 있다.</p>
<p><span class="math display">\[ \hat p_1 = \frac{n_{+1}}{n} = \frac{139+239}{22071} = 0.0171 \]</span> <span class="math display">\[\hat p_2 = \frac{n_{+2}}{n} = \frac{10898+10795}{22071} = 0.9829 \]</span></p>
<p>이제 각 셀의 기대도수를 식 @ref(eq:chisquareexp)에 의하여 계산할 수 있다. 예를 들어 <span class="math inline">\(E_{11}\)</span> 은 다음과 같이 계산된다.</p>
<p><span class="math display">\[ E_{11} = \frac{n_{1+}n_{+1}}{n} =  n_{1+} \hat p_1 = (11037)(0.0171) = 189.03 \]</span></p>
<p>각 셀에 대한 기대도수 <span class="math inline">\(E_{ij}\)</span> 를 구하고 식 @ref(eq:chisquarestat) 의 카이제곱 통계량을 구하면 다음과 같다.</p>
<p><span class="math display">\[\begin{align*}
\chi^2 &amp; = \frac{(139-189.03)^2}{189.03} +  \frac{(10898-10848.00)^2}{10848.00}  \\
&amp; \quad + \frac{(239-188.97)^2}{188.97} +  \frac{(10795-10845.03)^2}{10845.03}  \\
&amp; = 26.94
\end{align*}\]</span></p>
<p>자유도가 1인 카이제곱 분포의 상위 5% 백분위수 <span class="math inline">\(3.84\)</span> 이다. 위에서 구한 카이제곱 통계량의 값이 <span class="math inline">\(26.94\)</span> 로서 <span class="math inline">\(3.84\)</span> 보다 크므로 귀무가설을 기각한다. 즉 아스프린과 위약을 복용한 두 그룹 사이에는 심근경색이 일어날 비율에 유의한 차이가 있다.</p>
<p>R 에서도 카이제곱 검정을 쉽게 수행할 수 있다. 앞에서 표 @ref(tab:conttable25) 의 자료를 행렬의 형태로 저장하였는데 함수 <code>chisq.test()</code> 를 사용하면 결과를 쉽게 구할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ex1dat <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(<span class="dv">139</span>, <span class="dv">10898</span>, <span class="dv">239</span>, <span class="dv">10795</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ex1dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]
[1,]  139 10898
[2,]  239 10795</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ex1dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  ex1dat
X-squared = 26.408, df = 1, p-value = 2.764e-07</code></pre>
</div>
</div>
<p>분할표에서의 기대도수 <span class="math inline">\(E_{ij}\)</span> 는 다음과 같이 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ex1dat)<span class="sc">$</span>expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 189.0257 10847.97
[2,] 188.9743 10845.03</code></pre>
</div>
</div>
</section>
<section id="코크란-맨텔-헨젤-검정" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="코크란-맨텔-헨젤-검정"><span class="header-section-number">3.3</span> 코크란-맨텔-헨젤 검정</h2>
<p>임상실험이나 의학연구는 여러 나라 또는 여러 병원들에서 진행되는 경우가 있다. 이러한 경우 국가나 병원의 고유한 특성에 따라서 실험의 결과가 다르게 나타날 수 있다. 이렇게 그룹에 의한 효과를 그룹 효과 또는 층(strata)에 의한 효과라고 한다. 예를 들어 진통제에 대한 효과는 그 나라의 문화나 관습에 따라서 효과의 차이가 나타날 수 있다. 또한 여러 개의 변원에서 연그ㅜ가 동시에 진행된다면 병원의 규모, 위치, 환자들의 특성에 따라서 치료 효과의 차이가 나타날 수 있다.</p>
<p>이렇게 그룹에 따른 차이가 예상되는 경우 그룹의 효과를 제어하면서 처리 효과의 차이를 검정하는 방법이 필요하다. 이렇게 여러 개의 층으로 구성된 독립집단에서 얻은 자료에서 층에 의한 횩과를 통제하면서 동질성 또는 독립성 검정을 수행하는 방법을<br>
<strong>코크란-맨텔-헨젤 검정 (Cochran-Mantel-Haenzel test)</strong>라고 한다.</p>
<p>아래와 같이 <span class="math inline">\(K\)</span> 개의 독립집단(또는 층)에서 각각 얻은 <span class="math inline">\(K\)</span> 개의 <span class="math inline">\(2 \times2\)</span> 분할표가 있다고 하자.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/table22-k.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">K 개의 2 x 2 분할표</figcaption>
</figure>
</div>
<pre><code>table22k, out.width='60%',  echo=FALSE, fig.align='center', fig.cap= "K 개의 2 x 2 분할표"  }
knitr::include_graphics("myimages/table22-k.png")</code></pre>
<p><span class="math inline">\(K\)</span> 개의 독립집단이 있고 성공의 확률이 <span class="math inline">\(p_1\)</span>, 실패의 학률이 <span class="math inline">\(p_2\)</span> 라고 한다면 처리의 효과를 전체적으로 비교하는 가설은 다음과 같다.</p>
<p><span class="math display">\[ H_0: p_1 =p_2 \quad \text{sv.} \quad H_1: p_1 \ne p_2 \]</span></p>
<p>이제 귀무가설의 가정 하에서 각 분할표에서 <span class="math inline">\(n_{k11}\)</span> 에 대한 기대도수 <span class="math inline">\(\mu_{k11}\)</span> 와 그 분산 <span class="math inline">\(v_{k11}\)</span> 을 다음과 같이 계산한다.</p>
<p><span class="math display">\[
\mu_{k11} = E(n_{k11} | H_0) = \frac{ n_{k1+} n_{k+1} }{ n_k}
\]</span></p>
<p><span class="math display">\[
v_{k11} = V ( n_{k11} | H_0)  = \frac{ n_{k1+} n_{k2+} n_{k+1} n_{k+2} }{n^2_k (n_k-1)}
\]</span></p>
<p>이제 가설검정을 위한 통계량 <span class="math inline">\(Q_{CMH}\)</span> 은 다음과 같다.</p>
<p><span class="math display">\[\begin{equation}
Q_{CMH} = \frac{ \left [  \sum_{k=1}^K  (n_{k11} - \mu_{k11}) \right ]^2 }{\sum_{k=1}^K v_{k11}}
(\#eq:cmhstat)
\end{equation}\]</span></p>
<p>귀무가설이 참인 경우 검정통계량 <span class="math inline">\(Q_{CMH}\)</span> 은 자유도가 <span class="math inline">\(1\)</span> 인 카이제곱 분포를 따른다.</p>
<p>이제 <span class="citation" data-cites="agresti2003categorical">(<a href="../references.html#ref-agresti2003categorical" role="doc-biblioref"><strong>agresti2003categorical?</strong></a>)</span> 의 6.3절에 있는 <strong>다기관 임상시험(multi-center clinical trial)</strong> 의 예제를 살펴보자. 아래 표는 모두 8개의 독립적인 병원에서 감염 치료제에 대한 효과에 대한 실험을 실시하여 얻은 자료이다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/beitler-data.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">8개 병원의 임상실험 결과</figcaption>
</figure>
</div>
<pre><code>beitler, out.width='60%', echo=FALSE, fig.align='center', fig.cap= "8개 병원의 임상실험 결과 "  }
knitr::include_graphics("myimages/beitler-data.png")</code></pre>
<p>마지막 병원을 제외한 7개의 병원에서 치료제의 효과가 긍정적으로 나타났다. 여기서 주목할 점은 병원에 따라서 연관성의 강도가 매우 다르게 나타날 수 있다는 것이다.</p>
<p>이제 각 병원을 층(strata)로 고려하고 병원의 효과를 제어하면서 식 @ref(eq:cmhstat)의 검정 통계량 <span class="math inline">\(Q_{CMH}\)</span> 를 이용하여 치료제의 효과가 있는지 검정해보자. 검정은 아래와 같이 R 프로그램을 이용한다. 함수 <code>mantelhaen.test()</code> 는 코크란-맨텔-헨젤 검정을 수행하는 함수이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>beitler <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">27</span>,<span class="dv">16</span>,<span class="dv">22</span>,<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>beitler <span class="ot">&lt;-</span> <span class="fu">array</span>(beitler, <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">8</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>beitler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1

     [,1] [,2]
[1,]   11   25
[2,]   10   27

, , 2

     [,1] [,2]
[1,]   16    4
[2,]   22   10

, , 3

     [,1] [,2]
[1,]   14    5
[2,]    7   12

, , 4

     [,1] [,2]
[1,]    2   14
[2,]    1   16

, , 5

     [,1] [,2]
[1,]    6   11
[2,]    0   12

, , 6

     [,1] [,2]
[1,]    1   10
[2,]    0   10

, , 7

     [,1] [,2]
[1,]    1    4
[2,]    1    8

, , 8

     [,1] [,2]
[1,]    4    2
[2,]    6    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(beitler, <span class="at">correct=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mantel-Haenszel chi-squared test without continuity correction

data:  beitler
Mantel-Haenszel X-squared = 6.3841, df = 1, p-value = 0.01151
alternative hypothesis: true common odds ratio is not equal to 1
95 percent confidence interval:
 1.177590 3.869174
sample estimates:
common odds ratio 
         2.134549 </code></pre>
</div>
</div>
<p>검정 통계량 <span class="math inline">\(Q_{CMH}\)</span>의 값이 <span class="math inline">\(6.3841\)</span> 이고 p-값은 <span class="math inline">\(0.0115\)</span> 이므로 귀무가설을 기각한다.</p>
</section>
<section id="맥나마-검정" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="맥나마-검정"><span class="header-section-number">3.4</span> 맥나마 검정</h2>
<p>연속형 변수에서 짝지은 자료를 비교할 때 사용하는 방법이 대응 t-검정(paired t-test) 또는 짝표본 t-검정이다. 예를 들어 천식환자가 A약을 먹고 폐활량을 측정하고 일정 기간이 지나서 같은 환자가 B약을 먹고 폐활량을 측정하면 두 관측값은 독립이 아나다. 따라서 이러한 경우 독립 t-검정이 아닌 대응 t-검정을 시용한다.</p>
<p>이제 이산형 변수가 짝으로 나타나는 경우를 생각해보자. 예를 들어 눈병 치료에 사용되는 A약과 B약의 효과를비교하기 위하여 각각의 약을 환자의 오른쪽 눈과 왼쪽 눈에 처치를 하고 치료의 여부를 관측하였다고 하자.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/paired.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">짝표본 실험에 의한 2 x 2 분할표</figcaption>
</figure>
</div>
<pre><code>r macnamar, out.width='60%', echo=FALSE, fig.align='center', fig.cap= "짝표본 실험에 의한 2 x 2 분할표"  }
knitr::include_graphics("myimages/paired.png")</code></pre>
<p>위의 표에서 <span class="math inline">\(n_{11}\)</span> 은 A약과 B약의 효과가 모두 나타난 환자의 도수이다. <span class="math inline">\(n_{12}\)</span> 은 A약은 효과가 있고 B약은 효과가 없는 환자의 도수이다. 이러한 자료는 앞에서 배운 카이제곱 검정을 적용할 수 없다.</p>
<p>이제 일반적으로 짝표본에서 나온 자료가 다음 표와 같이 얻어졌다고 가정하자.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/paired2.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">짝표본 실험에 의한 2 x 2 분할표</figcaption>
</figure>
</div>
<pre><code>macnamar2, out.width='60%', echo=FALSE, fig.align='center', fig.cap= "짝표본  2 x 2 분할표"  }
knitr::include_graphics("myimages/paired2.png")</code></pre>
<p>이제 조건 1 에서 성공의 확률을 <span class="math inline">\(p_1\)</span> 이라고 하고 조건 2에서 성공의 확률을 <span class="math inline">\(p_2\)</span> 라고 하면 짝표본에서 얻어진 분할표 @ref(fig:macnamar2) 에서 관심있는 가설은 다음과 같다.</p>
<p><span class="math display">\[ H_0: p_1 =p_2 \quad \text{sv.} \quad H_1: p_1 \ne p_2 \]</span></p>
<p>분할표 @ref(fig:macnamar2)에서 <span class="math inline">\(p_1\)</span> 과 <span class="math inline">\(p_2\)</span>의 추정량은 다음과 같다.</p>
<p><span class="math display">\[ \hat p_1 = \frac{n_{1+}}{n}, \quad \hat p_2 = \frac{n_{+1}}{n} \]</span></p>
<p><span class="math inline">\(p_1\)</span> 과 <span class="math inline">\(p_2\)</span>의 추정량의 차이는 두 조건에 따른 결과가 일치하지 않는 도수 <span class="math inline">\(n_{12}\)</span>와 <span class="math inline">\(n_{21}\)</span>의 차이에 의존한다.</p>
<p><span class="math display">\[ \hat p_1 -\hat p_2 = \frac{n_{1+}}{n} - \frac{n_{+1}}{n} =
\frac{n_{11} + n_{12}}{n} - \frac{n_{11} + n_{21}}{n} = \frac{n_{12} - n_{21}}{n}
\]</span></p>
<p>맥나마 검정(McNemar Test)는 도수 <span class="math inline">\(n_{12}\)</span>와 <span class="math inline">\(n_{21}\)</span>에 의거하여 두 확률이 같은지 검정하는 방법을 제시하였다. 맥나마 검정을 위한 통계량은 다음과 같다.</p>
<p><span class="math display">\[\begin{equation}
Q_{M} = \frac{ (n_{12}-n_{21})^2}{n_{12} + n_{21}}
(\#eq:mcnemarstat)
\end{equation}\]</span></p>
<p>맥나마 검정 통계량 <span class="math inline">\(Q_{M}\)</span>은 귀무가설 하에서 근사적으로 자유도가 1인 카이제곱 분포를 따른다.</p>
<p>다음은 1600명 영국 시민들의 수상에 대한 지지 여부를 두 개의 연속된 여론 조사에서 수집한 자료이다 <span class="citation" data-cites="agresti2003categorical">(<a href="../references.html#ref-agresti2003categorical" role="doc-biblioref"><strong>agresti2003categorical?</strong></a> 의 10장 참조)</span>. 이제 두 시점에서 수상에 대한 지지율이 같은지 아닌지 R 을 이용하여 맥나마 검정을 해보자. 맥나마 검정은 함수 <code>mcnemar.test()</code>를 사용하여 수행할 수 있다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../myimages/paired-data.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">영국시민의 수상에 대한 지지도 조사 자료</figcaption>
</figure>
</div>
<pre><code>macnamar3, out.width='60%', echo=FALSE, fig.align='center', fig.cap= "영국시민의 수상에 대한 지지도 조사 자료"  }
knitr::include_graphics("myimages/paired-data.png")</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ex3dat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">794</span>,<span class="dv">150</span>,<span class="dv">86</span>,<span class="dv">570</span>),<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ex3dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  794  150
[2,]   86  570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.test</span>(ex3dat ,<span class="at">correct=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    McNemar's Chi-squared test

data:  ex3dat
McNemar's chi-squared = 17.356, df = 1, p-value = 3.099e-05</code></pre>
</div>
</div>
<p>검정의 p-값이 매우 작으므로 귀무가설을 기각한다. 두 시점에서 수상에 대한 지지율이 하락했다고 할 수 있다. 참고로 첫 번째 조사에서의 지지율의 추정치는 <span class="math inline">\(\hat p_1=944/1600= 0.59\)</span> 이고 두 번째 조사에서의 지지율의 추정치는 <span class="math inline">\(\hat p_2=880/1600= 0.55\)</span> 이다. 또한 의견을 바꾸지 않은 사람의 비율은 <span class="math inline">\((794+570)/1600=0.8225\)</span>로 대부분의 시민들이 지지 의견을 바꾸지 않았다.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/association.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">연관성의 측도</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/diagnose.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">진단의 평가</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>